{%load static tailwind_tags%}
{%load static%}
<html lang="en" data-theme="main">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Siparişinizi Tamamlayın</title>
  <link rel="stylesheet" href="{%static 'intern_app/css/checkout.css'%}">
  {% tailwind_css %}
</head>

<body>
  
<div class="container ">
  <div class="general-wrapper flex flex-col lg:flex-row gap-4 mx-10 lg:mx-40 p-6">
  <div class="tab active tabShow  iletisim  justify-center shadow-2xl  relative h-100 bg-white w-full lg:w-2/3  rounded-4xl  ">
    <form method="POST" id="regForm" enctype="multipart/form-data">
      {%csrf_token%}
      <div class="baslik pt-3 h-1 flex flex-row justify-center">Adres & İletişim Bilgileri </div>
      <div class="du-btn bg-green-100 hover:bg-green-300  justify-end p-5 ">
        
        <a href="{%url 'intern_app:index'%}" class="" type="button">
          
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4  ">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3" />
          </svg>
        </a>
      
      </div>
    <div class="iletisim-wrap  justify-center pt-10 p-5">
     <div class="isim-soyisim-wrapper gap-2   flex flex-row  ">
      <div class="ad  w-40 ">
        <label class="du-input  bg-white shadow du-validator">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 opacity-50 "><path stroke-linecap="round" stroke-linejoin="round" d="M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Zm6-10.125a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm1.294 6.336a6.721 6.721 0 0 1-3.17.789 6.721 6.721 0 0 1-3.168-.789 3.376 3.376 0 0 1 6.338 0Z" /></svg>
          <input required type="text" oninput="this.value=this.value.replace(/[^a-zA-Z]/g,'');" placeholder="İsim" name="isim" minlength="2">
        </label>
      
      </div>
      <div class="soyad   w-50 ">
        <label class="du-input  bg-white shadow du-validator" >
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 opacity-50">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Zm6-10.125a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm1.294 6.336a6.721 6.721 0 0 1-3.17.789 6.721 6.721 0 0 1-3.168-.789 3.376 3.376 0 0 1 6.338 0Z" />
          </svg>
          <input required type="text" oninput="this.value=this.value.replace(/[^a-zA-Z]/g,'');" placeholder="Soyisim" name="soyisim" minlength="2">
          
        </label>
      </div>
     </div>
     <div class="mail-tel-wrapper flex flex-row   gap-2 pt-2">
      <div class="email w-50 pb-1">
        <label class="du-input bg-white shadow du-validator">
          <svg class="h-[1em] opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" fill="none" stroke="currentColor"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></g></svg>
          <input   required type="email" placeholder="E-Mail" name="email" minlength="2">
        </label>
        
      </div>
      <div class="tel-no  w-40">
        <label class="du-input   bg-white shadow du-validator">
          <svg class="h-[1em] opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g fill="none"><path d="M7.25 11.5C6.83579 11.5 6.5 11.8358 6.5 12.25C6.5 12.6642 6.83579 13 7.25 13H8.75C9.16421 13 9.5 12.6642 9.5 12.25C9.5 11.8358 9.16421 11.5 8.75 11.5H7.25Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M6 1C4.61929 1 3.5 2.11929 3.5 3.5V12.5C3.5 13.8807 4.61929 15 6 15H10C11.3807 15 12.5 13.8807 12.5 12.5V3.5C12.5 2.11929 11.3807 1 10 1H6ZM10 2.5H9.5V3C9.5 3.27614 9.27614 3.5 9 3.5H7C6.72386 3.5 6.5 3.27614 6.5 3V2.5H6C5.44771 2.5 5 2.94772 5 3.5V12.5C5 13.0523 5.44772 13.5 6 13.5H10C10.5523 13.5 11 13.0523 11 12.5V3.5C11 2.94772 10.5523 2.5 10 2.5Z" fill="currentColor"></path></g></svg>
          <input required minlength="11" maxlength="11" type="text" oninput="this.value=this.value.replace(/[^0-9]/g,'');" name="telno" placeholder="05XX XXX XXXX">
        </label>
       
      </div>
     </div>
      <div class="adres flex flex-row gap-x-2 pt-1 gap-y-2">
        <div class="il w-25 ">
     
          <select required class="du-select bg-white" name="il" id="il">
            <option value="Seciniz">İl</option>
            <option value="İzmir">İzmir</option>
          </select>
        </div>
        <div class="ilce  left-1 w-25">
          
          <select required class="du-select bg-white" name="ilce"  id="ilce">
            <option value="Seciniz">İlçe</option>
            <option value="Buca">Buca</option>
            <option value="Bayrakli">Bayrakli</option>
          </select>
        </div>
        <div class="zipcode w-38 ">
          <label class="du-input bg-white shadow du-validator" >
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4  opacity-50">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
          </svg>
          <input  required minlength="5" maxlength="5" type="text" oninput="this.value=this.value.replace(/[^0-9]/g,'');" name="zipcode" placeholder="ZIP Kodu:35000">
        </label>
          
        </div>
        
    </div>
    <div class="acik-adres flex flex-col">
        
      <label  for="acikadres">Açık Adres
       
      </label>
      <textarea class="du-textarea w-92  bg-white" required  name="acikadres" id="acikadres"></textarea>
      </div>
    <div class="buton-ileri flex justify-center pt-3">
    
      <a class="du-btn  bg-green-100 hover:bg-green-300" onclick="tabs(1)" type="button" href="">Devam Et</a>
    
    </div>
  </div>
  </div>
  <div class="tab odeme tabShow  flex  justify-center shadow-2xl relative h-100 bg-white w-full lg:w-2/3 rounded-4xl  ">
    <div class="odeme-wrapper">
      <div class="odeme-baslik flex justify-center p-4">
        <span class="font-bold"><h1>Ödeme Yöntemi</h1></span>
      </div>
    <div class="odeme-yontemi flex gap-x-4 pb-4 ">
      <div class="kart">
        <span >Kredi/Banka Kartı</span>
        <input class="du-radio du-radio-info checked:bg-white " required checked="checked"  type="radio" name="odeme" id="kart">
       
      </div>
     <!-- <div class="havale">
        <span>EFT/Havale</span>
        <input class="du-radio du-radio-info checked:bg-white" required  type="radio" name="odeme" id="havale">
      </div>
      -->
    </div>
    <div class="kart-no-tarih justify-center flex flex-row gap-3 pb-4">
    <div class="kart-no">
      <label class="du-input bg-white shadow du-validator" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 opacity-50">
        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z" />
      </svg>
      <input required type="text" oninput="this.value=this.value.replace(/[^0-9]/g,'');" minlength="12" maxlength="12" name="kartno"  placeholder="16 Haneli Kart Numarası ">
      </label>
      
    </div>
    <div class="kart-tarih">
      <label class="du-input bg-white shadow du-validator" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 opacity-50">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" />
      </svg>

     
      <input required  type="text" oninput="this.value=this.value.replace(/[^0-9]/g,'');" minlength="5" maxlength="5" name="exp" id="expiry" placeholder="MM/YY">
      </label>
    </div>
  </div>
  <div class="kart-isim-cvc flex flex-row  gap-3">
    <div class="kart-ful-isim">
      <label class="du-input bg-white shadow du-validator" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 opacity-50">
        <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
      </svg>
      <input required  type="text" minlength="2" name="kart-isim" oninput="this.value=this.value.replace(/[^a-zA-Z\s]/g,'');" placeholder="İsim Soyisim">
      </label>
    </div>
    <div class="kart-cvc">
      <label class="du-input bg-white shadow du-validator" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 opacity-50">
        <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
      </svg>
      <input required type="password" oninput="this.value=this.value.replace(/[^0-9]/g,'');" minlength="3" maxlength="3" name="cvc" placeholder="***">
      </label>
     
    </div>
  </div>
  <div class="button-wrapper flex p-5 gap-x-5">
    <div class="flex justify-center ">
      
        <a class="du-btn du-btn-info" onclick="tabs(0);">Önceki Sayfaya Geri Dön</a>
   
    </div>
    <div class="submit ">
     <button type="submit">
       <a class="du-btn du-btn-success" type="button">Siparişi Tamamla</a>

     </button>
      
    </div>
   
  </div>
  </div>
</div>
  
  </form>

    <div class="sepet flex justify-center shadow-2xl relative h-100 bg-white w-full lg:w-2/3 rounded-4xl ">
      <div class="sepet-wrapper z-10 no-scrollbar overflow-y-scroll flex-1">
        <div class="genel-baslik  text-center font-medium pb-4">
          <div class="baslik  pt-4 pb-4">
            <h1>Sepet Özeti</h1>

          </div>
          <div class="border-b-2"></div>
        </div>
        <div class="basliklar flex flex-row gap-x-20 pb-5">
          <div class="baslik1">Ürün Görseli</div>
          <div class="baslik2">Ürün Adı</div>
          <div class="baslik3">Ürün Adedi</div>
          <div class="baslik4">Ürün Fiyatı</div>
        </div>
       
        <div class="urunler-wrapper flex flex-row gap-20 pr-4  ">
          <div class="urun-gorseli pl-4 justify-center ">
            <div class="du-avatar  w-12 h-12">
              <img src="{{quick_buy.item_name.product_image.url}}" alt="">
            </div>
          </div>
          <div class="urun-adi flex flex-row overflow-y-clip">
            <div class="urun-isim flex w-30   ">
              {{quick_buy.item_name}}
            </div>
          </div>
          <div class="urun-adedi">
            <div class="urun-adet">
            <span>{{quick_buy.item_quantity}} x {{quick_buy.item_name.product_price}}₺</span>
          </div>
          </div>
          <div class="urun-fiyati ">
            <div class="urun-fiyat ">
              <span>{{quick_buy.item_total}}₺</span>
            </div>
          </div>
        </div>
       
      </div>
      <div class="toplam-wrap  absolute top-90 z-1 mx-4 mb-4 w-full bg-white  shadow-2xl rounded-b-4xl h-32 flex items-center justify-between px-6">
        <div class="toplam-label ">
          <h1 class="text-3xl font-medium">Toplam</h1>
        </div>
        <div class="toplam-price">
          <h1 class="text-3xl font-bold text-green-500 text-right">{{quick_buy.item_total}}₺</h1>
        </div>
      </div>
  </div>
  
  
</div>


<script>
  // Kart tarih kısmında hem alfabeleri engellemek hemde 2 karakter girildikten sonra
  // otomatik olarak ortaya "/" koyma fonksiyonu
  const expiryInput = document.getElementById("expiry");

  expiryInput.addEventListener("input", (e) => {
    let value = e.target.value.replace(/\D/g, ""); // Numara olmayan karakterleri alma

    if (value.length >= 3) {
      value = value.slice(0, 2) + '/' + value.slice(2, 4);
    }

    e.target.value = value;
  });

  expiryInput.addEventListener("blur", () => {
    const value = expiryInput.value;
    const regex = /^(0[1-9]|1[0-2])\/\d{2}$/;

   
  });
</script>
<script src="{%static 'intern_app/js/jquery.js'%}"></script>
    <!-- Arayüzü değiştirme -->
    <script>
      // DOM'un yüklenmesini bekle
  document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('.tab');
    
    function showTab(index) {
      tabs.forEach((tab, i) => {
        if (i === index) {
          tab.classList.add('active');
          tab.style.display = 'flex';
        } else {
          tab.classList.remove('active');
          tab.style.display = 'none';
        }
      });
    }

    // İlk gösterilecek ekran
    showTab(0);

    
    window.tabs = function(index) {
      event.preventDefault();
      showTab(index);
    };
  });
    </script>
<script>
  window.addEventListener('beforeunload',function(event){
    fetch('/clear-quick-buy/',{
      method:'POST',
      headers:{
        'Content-Type':'application/json',
        'X-CSRFToken':'{{csrf_token}}',

      },
      body:JSON.stringify({user_id:'{{request.user.id}}'})
    });
  });
</script>
</body>

</html>